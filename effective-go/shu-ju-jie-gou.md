# 数据结构

## new

Go有两种分配元语，内建函数new和make。两者的行为不同，作用的类型也不同，这或许会造成困惑，但好在规则比较简单。首先介绍一下new，他是内建函数用来分配内存空间。不像其他语言中的new，Go中的new不会初始化内存，而只会置零。因此`new(T)`为一个类型为T的对象分配置零后的空间，然后返回内存地址，一个`*T`类型的值。用Go的术语说，他返回了一个指针，指向一个新分配的零值的T。

因为new返回的内存都被置零了，所以当你设计自己的数据结构时，每种类型的零值可以直接使用不需要进一步的初始化，这很方便。这意味着这个数据结构的使用者用new创造的实例可以直接可用。例如`bytes.Buffer`的文档中就说“Buffer的零值是一个空缓存，可以直接使用”，类似的`sync.Mutex`没有显式的构造器或Init方法。`sync.Mutex`的零值是一个unlocked mutex

“零值可用”这个特性是可以向下传递的，例如下面这个类型定义：

```go

type SyncedBuffer struct {
    lock    sync.Mutex
    buffer  bytes.Buffer
}

```

SyncedBuffer的实例在分配或声明后就可以立刻使用。下面这段代码中，p和v

